# 🔑 API密钥配置指南

本文档说明如何正确配置DeepSeek API密钥，确保AI客服系统正常运行。

## 📋 配置步骤

### 1. 获取API密钥

1. 访问 [DeepSeek平台](https://platform.deepseek.com/)
2. 注册账号并登录
3. 在控制台中创建新的API密钥
4. 复制生成的API密钥（格式类似：`cpk_xxxxxx...`）

### 2. 配置环境变量

#### 方法一：使用 .env 文件（推荐）

1. 复制项目根目录下的 `.env.example` 文件为 `.env`：
   ```bash
   cp .env.example .env
   ```

2. 编辑 `.env` 文件，设置您的API密钥：
   ```env
   LLM_API_KEY=your_actual_api_key_here
   ```

3. 保存文件并重启应用

#### 方法二：设置系统环境变量

**Windows:**
```cmd
set LLM_API_KEY=your_actual_api_key_here
```

**Linux/macOS:**
```bash
export LLM_API_KEY=your_actual_api_key_here
```

### 3. 验证配置

启动应用时，系统会自动验证API密钥配置：

- ✅ **配置成功**：显示 "API密钥配置成功"
- ❌ **配置失败**：显示详细的错误信息和解决步骤

## 🔒 安全最佳实践

### 必须遵守的安全规则：

1. **永远不要将API密钥硬编码在代码中**
2. **不要将 .env 文件提交到代码仓库**
3. **定期更换API密钥**
4. **使用强密钥和随机字符串**

### 推荐的安全措施：

- 为 `.env` 文件设置适当的文件权限（仅所有者可读写）
- 在生产环境中使用专用的密钥管理服务
- 监控API密钥的使用情况
- 设置API使用限额和警报

## ⚠️ 常见问题

### Q: 启动时提示"未设置LLM_API_KEY环境变量"

**解决方案：**
1. 检查 `.env` 文件是否存在且包含 `LLM_API_KEY` 配置
2. 确认API密钥格式正确（不包含多余的空格或引号）
3. 重启应用程序

### Q: API密钥设置了但仍然报错

**解决方案：**
1. 检查API密钥是否有效（未过期或被撤销）
2. 确认API密钥有足够的使用额度
3. 验证网络连接是否正常

### Q: 如何在生产环境中安全地配置API密钥？

**建议：**
1. 使用云平台的密钥管理服务（如AWS Secrets Manager）
2. 通过CI/CD管道安全地注入环境变量
3. 避免在日志中记录敏感信息

## 🔧 技术实现

系统采用以下安全机制：

1. **强制环境变量读取**：移除了代码中的默认API密钥
2. **启动时验证**：应用启动时自动检查API密钥配置
3. **友好错误提示**：提供详细的配置指导信息
4. **格式验证**：基本的API密钥格式检查

## 📞 技术支持

如果在配置过程中遇到问题：

1. 检查本文档的常见问题部分
2. 查看应用启动时的错误信息
3. 确认DeepSeek平台的API密钥状态
4. 联系技术支持团队

---

**重要提醒：** 保护好您的API密钥，它相当于您账户的访问凭证。任何泄露都可能导致安全风险和费用损失。
