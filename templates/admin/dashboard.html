<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理员控制台 - 果蔬客服AI系统</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
</head>
<body class="admin-page">
    <div class="admin-container">
        <!-- 侧边栏 -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>🍎🥬 管理后台</h2>
                <p>欢迎，<span id="adminUsername">管理员</span></p>
            </div>
            
            <ul class="sidebar-menu">
                <li><a href="#dashboard" class="menu-item active" data-section="dashboard">📊 控制台</a></li>
                <li><a href="#inventory" class="menu-item" data-section="inventory">📦 库存管理</a></li>
                <li class="menu-submenu">
                    <a href="#inventory-add-product" class="menu-item" data-section="inventory-add-product">📦 产品入库</a>
                    <a href="#inventory-counts" class="menu-item" data-section="inventory-counts">📊 库存盘点</a>
                    <a href="#inventory-analysis" class="menu-item" data-section="inventory-analysis">📈 数据对比分析</a>
                </li>
                <li><a href="#feedback" class="menu-item" data-section="feedback">💬 反馈管理</a></li>
                <li><a href="#logs" class="menu-item" data-section="logs">📋 操作日志</a></li>
                <li><a href="#export" class="menu-item" data-section="export">📤 数据导出</a></li>
                <li><a href="#settings" class="menu-item" data-section="settings">⚙️ 系统设置</a></li>
            </ul>
            
            <div class="sidebar-footer">
                <button id="logoutBtn" class="logout-btn">退出登录</button>
                <p><a href="/" target="_blank">查看客服系统</a></p>
            </div>
        </nav>
        
        <!-- 主内容区 -->
        <main class="main-content">
            <!-- 控制台概览 -->
            <section id="dashboardSection" class="content-section active">
                <div class="section-header">
                    <h1>📊 系统概览</h1>
                    <p>果蔬客服AI系统管理控制台</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">📦</div>
                        <div class="stat-info">
                            <h3 id="totalProducts">-</h3>
                            <p>总产品数</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">⚠️</div>
                        <div class="stat-info">
                            <h3 id="lowStockCount">-</h3>
                            <p>低库存产品</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">💬</div>
                        <div class="stat-info">
                            <h3 id="totalFeedback">-</h3>
                            <p>总反馈数</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">⏳</div>
                        <div class="stat-info">
                            <h3 id="pendingFeedback">-</h3>
                            <p>待处理反馈</p>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-content">
                    <div class="dashboard-row">
                        <div class="dashboard-card">
                            <h3>📈 库存状态</h3>
                            <div id="inventoryStatus">
                                <p>正在加载...</p>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <h3>📝 最新反馈</h3>
                            <div id="recentFeedback">
                                <p>正在加载...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- 库存管理 -->
            <section id="inventorySection" class="content-section">
                <div class="section-header">
                    <h1>📦 库存管理</h1>
                    <button id="addProductBtn" class="primary-btn">+ 添加产品</button>
                </div>
                
                <div class="inventory-controls">
                    <div class="search-box">
                        <input type="text" id="inventorySearch" placeholder="搜索产品...">
                        <button id="searchInventoryBtn">🔍</button>
                    </div>
                    
                    <div class="filter-controls">
                        <select id="categoryFilter">
                            <option value="">所有分类</option>
                        </select>
                        <select id="statusFilter">
                            <option value="">所有状态</option>
                            <option value="active">正常</option>
                            <option value="inactive">停用</option>
                        </select>
                    </div>
                </div>
                
                <div class="inventory-table-container">
                    <table id="inventoryTable" class="data-table">
                        <thead>
                            <tr>
                                <th>产品名称</th>
                                <th>分类</th>
                                <th>价格</th>
                                <th>当前库存</th>
                                <th>状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryTableBody">
                            <tr>
                                <td colspan="6" class="loading">正在加载库存数据...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- 反馈管理 -->
            <section id="feedbackSection" class="content-section">
                <div class="section-header">
                    <h1>💬 客户反馈管理</h1>
                    <button id="addFeedbackBtn" class="primary-btn">+ 添加反馈</button>
                </div>
                
                <div class="feedback-controls">
                    <div class="search-box">
                        <input type="text" id="feedbackSearch" placeholder="搜索反馈...">
                        <button id="searchFeedbackBtn">🔍</button>
                    </div>
                    
                    <div class="filter-controls">
                        <select id="feedbackTypeFilter">
                            <option value="">所有类型</option>
                            <option value="positive">正面反馈</option>
                            <option value="negative">负面反馈</option>
                        </select>
                        <select id="feedbackStatusFilter">
                            <option value="">所有状态</option>
                            <option value="待处理">待处理</option>
                            <option value="处理中">处理中</option>
                            <option value="已解决">已解决</option>
                        </select>
                    </div>
                </div>
                
                <div class="feedback-table-container">
                    <table id="feedbackTable" class="data-table">
                        <thead>
                            <tr>
                                <th>产品名称</th>
                                <th>客户昵称</th>
                                <th>反馈类型</th>
                                <th>付款状态</th>
                                <th>处理状态</th>
                                <th>反馈时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="feedbackTableBody">
                            <tr>
                                <td colspan="7" class="loading">正在加载反馈数据...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- 操作日志 -->
            <section id="logsSection" class="content-section">
                <div class="section-header">
                    <h1>📋 操作日志</h1>
                    <button id="refreshLogsBtn" class="primary-btn">🔄 刷新</button>
                </div>

                <div class="logs-controls">
                    <div class="filter-controls">
                        <select id="logOperatorFilter">
                            <option value="">所有操作员</option>
                        </select>
                        <select id="logOperationFilter">
                            <option value="">所有操作</option>
                            <option value="create">创建</option>
                            <option value="update">更新</option>
                            <option value="delete">删除</option>
                            <option value="update_stock">库存调整</option>
                            <option value="export">数据导出</option>
                        </select>
                        <select id="logTargetFilter">
                            <option value="">所有目标</option>
                            <option value="inventory">库存</option>
                            <option value="feedback">反馈</option>
                            <option value="admin">管理员</option>
                        </select>
                        <input type="number" id="logLimitInput" value="100" min="10" max="1000" placeholder="显示条数">
                    </div>
                </div>

                <div class="logs-table-container">
                    <table id="logsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>时间</th>
                                <th>操作员</th>
                                <th>操作类型</th>
                                <th>目标类型</th>
                                <th>目标ID</th>
                                <th>结果</th>
                                <th>详情</th>
                            </tr>
                        </thead>
                        <tbody id="logsTableBody">
                            <tr>
                                <td colspan="7" class="loading">正在加载日志数据...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- 数据导出 -->
            <section id="exportSection" class="content-section">
                <div class="section-header">
                    <h1>📤 数据导出</h1>
                </div>

                <div class="export-content">
                    <div class="export-card">
                        <h3>📦 库存数据导出</h3>
                        <p>导出所有产品和库存信息</p>
                        <div class="export-actions">
                            <button class="primary-btn" onclick="admin.exportData('inventory', 'csv')">导出CSV</button>
                            <button class="secondary-btn" onclick="admin.exportData('inventory', 'json')">导出JSON</button>
                            <button class="secondary-btn" onclick="admin.generateReport('inventory')">生成报告</button>
                        </div>
                    </div>

                    <div class="export-card">
                        <h3>💬 反馈数据导出</h3>
                        <p>导出所有客户反馈信息</p>
                        <div class="export-actions">
                            <button class="primary-btn" onclick="admin.exportData('feedback', 'csv')">导出CSV</button>
                            <button class="secondary-btn" onclick="admin.exportData('feedback', 'json')">导出JSON</button>
                            <button class="secondary-btn" onclick="admin.generateReport('feedback')">生成报告</button>
                        </div>
                    </div>

                    <div class="export-card">
                        <h3>📋 操作日志导出</h3>
                        <p>导出系统操作日志</p>
                        <div class="export-date-range">
                            <label for="exportStartDate">开始日期:</label>
                            <input type="date" id="exportStartDate">
                            <label for="exportEndDate">结束日期:</label>
                            <input type="date" id="exportEndDate">
                        </div>
                        <div class="export-actions">
                            <button class="primary-btn" onclick="admin.exportLogs('csv')">导出CSV</button>
                            <button class="secondary-btn" onclick="admin.exportLogs('json')">导出JSON</button>
                        </div>
                    </div>

                    <div class="export-card">
                        <h3>💾 完整数据备份</h3>
                        <p>导出所有系统数据的完整备份</p>
                        <div class="export-actions">
                            <button class="primary-btn" onclick="admin.createBackup()">创建备份</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 系统设置 -->
            <section id="settingsSection" class="content-section">
                <div class="section-header">
                    <h1>⚙️ 系统设置</h1>
                </div>

                <div class="settings-content">
                    <div class="settings-card">
                        <h3>🔐 修改密码</h3>
                        <form id="changePasswordForm">
                            <div class="form-group">
                                <label for="oldPassword">当前密码</label>
                                <input type="password" id="oldPassword" required>
                            </div>
                            <div class="form-group">
                                <label for="newPassword">新密码</label>
                                <input type="password" id="newPassword" required>
                            </div>
                            <div class="form-group">
                                <label for="confirmPassword">确认新密码</label>
                                <input type="password" id="confirmPassword" required>
                            </div>
                            <button type="submit" class="primary-btn">修改密码</button>
                        </form>
                    </div>

                    <div class="settings-card">
                        <h3>📊 系统信息</h3>
                        <div class="system-info">
                            <p><strong>系统版本：</strong>2.0</p>
                            <p><strong>最后更新：</strong><span id="lastUpdate">-</span></p>
                            <p><strong>运行状态：</strong><span class="status-active">正常运行</span></p>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>🧹 系统维护</h3>
                        <div class="maintenance-actions">
                            <button class="secondary-btn" onclick="admin.clearOldLogs()">清理旧日志</button>
                            <button class="secondary-btn" onclick="admin.optimizeDatabase()">优化数据</button>
                            <button class="danger-btn" onclick="admin.resetSystem()">重置系统</button>
                        </div>
                        <p class="maintenance-note">注意：系统维护操作可能影响系统性能，请在低峰期执行。</p>
                    </div>
                </div>
            </section>

            <!-- 产品入库页面 -->
            <section id="inventory-add-productSection" class="content-section">
                <div class="section-header">
                    <div>
                        <h1>📦 产品入库</h1>
                        <p>添加新产品到库存系统，自动生成条形码</p>
                    </div>
                </div>

                <div class="add-product-container">
                    <div class="add-product-form-section">
                        <div class="form-card">
                            <h3>产品信息</h3>
                            <form id="addProductForm" class="product-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="productName">产品名称 *</label>
                                        <input type="text" id="productName" name="product_name" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="productCategory">产品分类 *</label>
                                        <select id="productCategory" name="category" required>
                                            <option value="">请选择分类</option>
                                            <option value="水果">水果</option>
                                            <option value="蔬菜">蔬菜</option>
                                            <option value="肉类">肉类</option>
                                            <option value="海鲜">海鲜</option>
                                            <option value="熟食">熟食</option>
                                            <option value="其他">其他</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="productPrice">价格 *</label>
                                        <input type="text" id="productPrice" name="price" placeholder="例：15元/斤" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="productUnit">单位 *</label>
                                        <select id="productUnit" name="unit" required>
                                            <option value="">请选择单位</option>
                                            <option value="斤">斤</option>
                                            <option value="个">个</option>
                                            <option value="包">包</option>
                                            <option value="盒">盒</option>
                                            <option value="袋">袋</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="productSpecification">规格</label>
                                        <input type="text" id="productSpecification" name="specification" placeholder="例：500g/包">
                                    </div>
                                    <div class="form-group">
                                        <label for="storageArea">存储区域 *</label>
                                        <select id="storageArea" name="storage_area" required>
                                            <option value="">请选择存储区域</option>
                                            <option value="A">A区 - 水果区</option>
                                            <option value="B">B区 - 蔬菜区</option>
                                            <option value="C">C区 - 肉类区</option>
                                            <option value="D">D区 - 海鲜区</option>
                                            <option value="E">E区 - 熟食区</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="initialStock">初始库存</label>
                                        <input type="number" id="initialStock" name="initial_stock" min="0" value="0">
                                    </div>
                                    <div class="form-group">
                                        <label for="minStockWarning">最小库存警告</label>
                                        <input type="number" id="minStockWarning" name="min_stock_warning" min="0" value="10">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="productDescription">产品描述</label>
                                    <textarea id="productDescription" name="description" rows="3" placeholder="产品特点、产地、保存方法等"></textarea>
                                </div>

                                <div class="form-group">
                                    <label for="productImageUrl">产品图片URL</label>
                                    <input type="url" id="productImageUrl" name="image_url" placeholder="https://example.com/image.jpg">
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="primary-btn">保存产品</button>
                                    <button type="reset" class="secondary-btn">重置表单</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <div class="add-product-preview-section">
                        <div class="preview-card">
                            <h3>条形码预览</h3>
                            <div id="barcodePreview" class="barcode-preview">
                                <div class="barcode-placeholder">
                                    <p>📊</p>
                                    <p>输入产品信息后将自动生成条形码</p>
                                </div>
                            </div>
                            <div id="barcodeInfo" class="barcode-info" style="display: none;">
                                <p><strong>条形码：</strong><span id="barcodeNumber">-</span></p>
                                <p><strong>产品ID：</strong><span id="productId">-</span></p>
                            </div>
                        </div>

                        <div class="storage-info-card">
                            <h3>存储区域信息</h3>
                            <div id="storageAreaInfo" class="storage-area-info">
                                <div class="area-item">
                                    <span class="area-label">A区</span>
                                    <span class="area-desc">水果类产品</span>
                                </div>
                                <div class="area-item">
                                    <span class="area-label">B区</span>
                                    <span class="area-desc">蔬菜类产品</span>
                                </div>
                                <div class="area-item">
                                    <span class="area-label">C区</span>
                                    <span class="area-desc">肉类产品</span>
                                </div>
                                <div class="area-item">
                                    <span class="area-label">D区</span>
                                    <span class="area-desc">海鲜类产品</span>
                                </div>
                                <div class="area-item">
                                    <span class="area-label">E区</span>
                                    <span class="area-desc">熟食类产品</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 库存盘点页面 -->
            <section id="inventory-countsSection" class="content-section">
                <div class="section-header">
                    <div>
                        <h1>📊 库存盘点</h1>
                        <p>创建和管理库存盘点任务，支持条形码扫描和手动录入</p>
                    </div>
                    <button id="createCountTaskBtn" class="primary-btn">+ 创建新盘点</button>
                </div>

                <!-- 盘点任务管理区域 -->
                <div class="count-tasks-section">
                    <div class="tasks-card">
                        <h3>盘点任务列表</h3>
                        <div class="tasks-controls">
                            <div class="filter-controls">
                                <select id="countStatusFilter">
                                    <option value="">所有状态</option>
                                    <option value="in_progress">进行中</option>
                                    <option value="completed">已完成</option>
                                    <option value="cancelled">已取消</option>
                                </select>
                                <button id="refreshCountTasksBtn" class="secondary-btn">刷新</button>
                            </div>
                        </div>
                        <div class="count-tasks-table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>任务ID</th>
                                        <th>创建时间</th>
                                        <th>操作员</th>
                                        <th>状态</th>
                                        <th>产品数量</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody id="countTasksTableBody">
                                    <tr><td colspan="6" class="loading">加载中...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- 当前盘点操作区域 -->
                <div id="currentCountSection" class="current-count-section" style="display: none;">
                    <div class="count-operation-container">
                        <div class="count-input-section">
                            <div class="input-card">
                                <h3>添加盘点产品</h3>
                                <div class="input-methods">
                                    <div class="input-method">
                                        <label for="barcodeInput">条形码扫描/输入</label>
                                        <div class="barcode-input-group">
                                            <input type="text" id="barcodeInput" placeholder="扫描或输入条形码">
                                            <button id="addByBarcodeBtn" class="primary-btn">添加</button>
                                        </div>
                                    </div>
                                    <div class="input-divider">或</div>
                                    <div class="input-method">
                                        <label for="productSearchInput">产品搜索</label>
                                        <div class="product-search-group">
                                            <input type="text" id="productSearchInput" placeholder="搜索产品名称">
                                            <button id="searchProductBtn" class="secondary-btn">搜索</button>
                                        </div>
                                        <div id="productSearchResults" class="search-results" style="display: none;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="count-list-section">
                            <div class="list-card">
                                <h3>当前盘点项目</h3>
                                <div id="currentCountInfo" class="count-info">
                                    <span>任务ID: <strong id="currentCountId">-</strong></span>
                                    <span>创建时间: <strong id="currentCountDate">-</strong></span>
                                    <span>项目数量: <strong id="currentCountItemsCount">0</strong></span>
                                </div>
                                <div class="count-items-table-container">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>产品名称</th>
                                                <th>条形码</th>
                                                <th>存储区域</th>
                                                <th>账面数量</th>
                                                <th>实际数量</th>
                                                <th>差异</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody id="countItemsTableBody">
                                            <tr><td colspan="7" class="no-data">暂无盘点项目</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="count-summary">
                                    <div class="summary-stats">
                                        <span>总项目: <strong id="totalCountItems">0</strong></span>
                                        <span>已录入: <strong id="recordedCountItems">0</strong></span>
                                        <span>有差异: <strong id="differenceCountItems">0</strong></span>
                                    </div>
                                    <div class="count-actions">
                                        <button id="completeCountBtn" class="primary-btn" disabled>完成盘点</button>
                                        <button id="cancelCountBtn" class="danger-btn">取消盘点</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 数据对比分析页面 -->
            <section id="inventory-analysisSection" class="content-section">
                <div class="section-header">
                    <div>
                        <h1>📈 数据对比分析</h1>
                        <p>对比不同时期的库存数据，分析变化趋势和异常情况</p>
                    </div>
                </div>

                <!-- 对比分析创建区域 -->
                <div class="analysis-creation-section">
                    <div class="creation-card">
                        <h3>创建对比分析</h3>
                        <div class="creation-methods">
                            <div class="method-group">
                                <div class="method-item">
                                    <h4>周对比分析</h4>
                                    <p>自动对比最近一周的盘点数据</p>
                                    <button id="createWeeklyAnalysisBtn" class="primary-btn">生成周对比</button>
                                </div>
                                <div class="method-item">
                                    <h4>手动对比选择</h4>
                                    <p>选择两个盘点任务进行对比</p>
                                    <div class="manual-comparison">
                                        <div class="comparison-selects">
                                            <div class="select-group">
                                                <label>当前盘点:</label>
                                                <select id="currentCountSelect">
                                                    <option value="">请选择盘点任务</option>
                                                </select>
                                            </div>
                                            <div class="select-group">
                                                <label>对比盘点:</label>
                                                <select id="previousCountSelect">
                                                    <option value="">请选择盘点任务</option>
                                                </select>
                                            </div>
                                        </div>
                                        <button id="createManualAnalysisBtn" class="primary-btn">开始对比</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 分析结果展示区域 -->
                <div id="analysisResultsSection" class="analysis-results-section" style="display: none;">
                    <!-- 统计汇总卡片 -->
                    <div class="analysis-summary">
                        <div class="summary-cards">
                            <div class="summary-card">
                                <div class="card-icon">📦</div>
                                <div class="card-info">
                                    <h4 id="totalProductsAnalyzed">0</h4>
                                    <p>总产品数</p>
                                </div>
                            </div>
                            <div class="summary-card">
                                <div class="card-icon">📊</div>
                                <div class="card-info">
                                    <h4 id="changedProductsCount">0</h4>
                                    <p>变化产品数</p>
                                </div>
                            </div>
                            <div class="summary-card">
                                <div class="card-icon">⚠️</div>
                                <div class="card-info">
                                    <h4 id="anomaliesCount">0</h4>
                                    <p>异常项目数</p>
                                </div>
                            </div>
                            <div class="summary-card">
                                <div class="card-icon">💰</div>
                                <div class="card-info">
                                    <h4 id="totalValueChange">0</h4>
                                    <p>总价值变化</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 变化明细表格 -->
                    <div class="changes-detail-section">
                        <div class="detail-card">
                            <h3>变化明细</h3>
                            <div class="detail-controls">
                                <div class="filter-controls">
                                    <select id="changeTypeFilter">
                                        <option value="">所有变化</option>
                                        <option value="increased">库存增加</option>
                                        <option value="decreased">库存减少</option>
                                        <option value="new">新增产品</option>
                                        <option value="removed">移除产品</option>
                                    </select>
                                    <select id="categoryAnalysisFilter">
                                        <option value="">所有分类</option>
                                    </select>
                                </div>
                            </div>
                            <div class="changes-table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>产品名称</th>
                                            <th>分类</th>
                                            <th>存储区域</th>
                                            <th>之前数量</th>
                                            <th>当前数量</th>
                                            <th>变化量</th>
                                            <th>变化百分比</th>
                                            <th>状态</th>
                                        </tr>
                                    </thead>
                                    <tbody id="changesTableBody">
                                        <tr><td colspan="8" class="no-data">暂无变化数据</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- 异常检测结果 -->
                    <div class="anomalies-section">
                        <div class="anomalies-card">
                            <h3>异常检测结果</h3>
                            <div id="anomaliesList" class="anomalies-list">
                                <div class="no-data">暂无异常检测结果</div>
                            </div>
                        </div>
                    </div>

                    <!-- 报表生成功能 -->
                    <div class="reports-section">
                        <div class="reports-card">
                            <h3>报表生成</h3>
                            <div class="report-actions">
                                <button id="downloadAnalysisReportBtn" class="primary-btn">📄 下载分析报告</button>
                                <button id="downloadChangesExcelBtn" class="secondary-btn">📊 导出Excel</button>
                                <button id="generateTrendChartBtn" class="secondary-btn">📈 生成趋势图</button>
                            </div>
                            <div id="analysisInfo" class="analysis-info">
                                <p><strong>分析时间：</strong><span id="analysisDate">-</span></p>
                                <p><strong>对比范围：</strong><span id="analysisRange">-</span></p>
                                <p><strong>分析类型：</strong><span id="analysisType">-</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <!-- 模态框 -->
    <div id="modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- 模态框模板 -->
    {% include 'admin/modals.html' %}

    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
</body>
</html>
